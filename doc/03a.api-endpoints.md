

# Tenbeo Auth API

### Tenbeo Auth Application
TODO - You need to create a **Tenbeo Auth Application** in the Admin Panel to allow new users to connect.

### Cors
TODO - talk about CORS and cross domain cookies

### User Object


---

# Endpoints

### GET `/api/1.0/create/{app-slug}`
#### origin : **browser**

Call this API from the front-end of your application to create a new Tenbeo Login QR-Code.
This will attach a new session, and register it with a cookie on the client.

Only users which subscribes to the **Tenbeo Auth Application** ( app-slug param ) will be able to connect. 

#### return : **json**
```json5
{
  "session": {
	// PENDING if user has not connected with Tenbeo Mobile App
	// VALIDATED if user is already connected
	"status" : "PENDING" | "VALIDATED",
	// The created or retrieved session ID 
	"id" : string,
  },
  // If user is already connected
  "user" : UserObject,
  // If user is not already connected
  "login" : {
	// Base64 image of the validate command in a QR-Code
	// <img src={ response.login.qr } /> will show it
	"qr" : string,
	// URL of the validate command for this session
	// Useful if you want to implement your own QR Code
	"url" : string
  }
}
```

> If user is already logged, the QR-Code will be omitted from the return.
> The front-end can check for `session.status === "VALIDATED"` to redirect to the secured area.  

- talk about already logged
- talk about return object : session / user / login

> If you need to force session recreation, `?force-recreation` will logout any connected user, and return a new session.

> If QR-Code changes each time the `create` endpoint is called, check that the fetch send credentials. It surely means that session cookie is not sent to the API and cannot keep connection steady.



### GET `/api/1.0/track/{app-slug}`
#### origin : **browser**

Call this API from the front-end, to check if the user has logged.

> **app-slug** parameter has to be sent because users can have 1 session by app.

#### return : **json**
```json
{
  "session" : {
	"status" : "PENDING" | "VALIDATED" | "EXPIRED",
	"id" : string
  },
  "user" : UserObject
}
```



### POST `/api/1.0/verify-session/{session-id}`
#### origin : backend

Call this API from your backend to verify the status of a session.

Use case :
- A user connects to a backend you implemented.




### POST `/api/1.0/logout/{app-slug}`

- origin : browser


### POST `/api/1.0/validate`

- origin : tenbeo app

### GET `/api/1.0/validate`

- origin : front end

- talk about when it's used, what it does and the dot env
