
# Setup a new instance of Tenbeo Auth manually

**Dependencies**

- Git 
- Node v18+ and npm

Because the admin is secured with **Tenbeo Login**, you will also need the **Tenbeo Mobile App** installed, an _Alive Core device_, and your _Tenbeo public key_. 

### 1. Clone repository

First of all, clone the latest application version from its repository.

- `git clone https://github.com/Tenbeo/Tenbeo-Auth.git tenbeo-auth-instance`
- `cd tenbeo-auth-instance`

### 2. Install dependencies

- `npm i`

### 3. Configure

Copy `.env.default` to `.env`.
The only line to change is `TENBEO_AUTH_PINGBACK_URL`, set the domain name where the auth instance will be deployed ( ex : "https://tenbeo-auth.mycorp.com" ), include protocol, no trailing slash.

> This middleware should be deployed with `https` to allow **cross-site session cookies** to be installed. See [deploy](#6-deploy) for more info about deployment.

### 5. Build

To build for production
- `npm run server-build`

To check it on localhost
- `npm run server-preview`

> Note that **Tenbeo Login** will not work on localhost and you will not be able to log into the Admin Panel because the **Tenbeo Mobile App** do a validation request to the **Tenbeo Auth Instance**.

You can simulate a successful login like so :
- Create a user on `/setup`, any name and any public key will do it.
- Then go to the login page on `/admin`
- Open the `data/auth.db` with any sqlite editor ( [DataFlare](https://dataflare.app/) will do it well )
- Open the `session` column and set `user_id` to `1` and `status` to `VALIDATED`
- You should be connected locally to the Admin Panel

### 6. Deploy

To deploy your **Tenbeo Auth Instance**, setup a new CI / CD pipeline associated to your cloned repository.
[More info here to deploy on a VPS with docker and GitHub](./01c.setup-deploy.md).

